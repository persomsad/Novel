# v0.1.0 Milestone - MVP 版本

## 核心目标

构建一个可用的 MVP，验证 ReAct Agent 架构的可行性。

**完成标准**：
- 所有 P0 Issue 完成
- Agent 能完成基础创作任务（创建章节）
- Agent 能完成基础一致性检查（发现角色矛盾）
- 本地测试通过（pytest 覆盖率 >70%）

**预计时间**：1 周

---

## P0 Issue 清单（阻塞发布）

### #1: 项目初始化
- [x] 创建项目结构
- [x] 配置 Git 和文档
- [x] 初始 commit

### #2: 使用 Poetry 初始化 Python 项目
**描述**：使用官方工具 `poetry new` 创建 Python 项目结构

**验收标准**：
- [ ] 运行 `poetry new novel-agent`
- [ ] 配置 `pyproject.toml`（依赖、版本、脚本）
- [ ] 目录结构正确（src/novel_agent/, tests/）
- [ ] 运行 `poetry install` 成功

**Dependencies**: None

### #3: 实现 5 个核心工具
**描述**：实现 Agent 的工具函数

**验收标准**：
- [ ] `read_file(path)` - 读取任意文件
- [ ] `write_chapter(number, content)` - 创建新章节
- [ ] `search_content(keyword)` - 搜索关键词
- [ ] `verify_strict_timeline()` - 调用时间线检查脚本
- [ ] `verify_strict_references()` - 调用引用检查脚本
- [ ] 所有工具有单元测试

**Dependencies**: #2

### #4: 实现 ReAct Agent
**描述**：使用 LangChain 创建 ReAct Agent

**验收标准**：
- [ ] 配置 Gemini API 连接
- [ ] 使用 `create_agent` 创建 Agent
- [ ] 集成 5 个工具
- [ ] 配置 system prompt（参考 ADR-001）
- [ ] 测试：Agent 能调用工具

**Dependencies**: #3

### #5: 实现 CLI 界面
**描述**：使用 Typer + Rich 创建命令行界面

**验收标准**：
- [ ] 命令：`novel-agent chat` - 启动对话
- [ ] 命令：`novel-agent check` - 一致性检查
- [ ] 使用 Rich 美化输出（彩色、进度条）
- [ ] 支持 Ctrl+C 优雅退出

**Dependencies**: #4

### #6: 会话持久化
**描述**：使用 LangGraph MemorySaver 实现会话保存

**验收标准**：
- [ ] 会话保存到 `.novel-agent/sessions/`
- [ ] 支持恢复之前的会话
- [ ] 测试：退出后重新进入，历史消息还在

**Dependencies**: #4

### #7: 一致性检查验证
**描述**：验证 Agent 能发现一致性问题

**验收标准**：
- [ ] 测试场景1：Agent 发现角色性格矛盾
- [ ] 测试场景2：Agent 发现情节逻辑问题
- [ ] 测试场景3：脚本检查时间线数字错误
- [ ] 测试场景4：脚本检查引用 ID 不存在
- [ ] Agent 能提供修复建议

**Dependencies**: #4, #3

---

## P1 Issue 清单（重要但非阻塞）

### #8: 配置自动化工具
**描述**：配置 pre-commit hooks 和 GitHub Actions

**验收标准**：
- [ ] 安装 pre-commit: `pre-commit install`
- [ ] commit 时自动运行：black, ruff, mypy
- [ ] push 时自动运行：pytest
- [ ] GitHub Actions CI 配置正确

**Dependencies**: #2

### #9: 编写单元测试
**描述**：为所有工具函数编写单元测试

**验收标准**：
- [ ] 测试覆盖率 >70%
- [ ] 每个工具至少 3 个测试用例
- [ ] 使用 Mock 测试 LLM 调用

**Dependencies**: #3

### #10: 编写集成测试
**描述**：测试完整的 Agent 工作流

**验收标准**：
- [ ] 测试：创建第1章（端到端）
- [ ] 测试：检查一致性（端到端）
- [ ] 测试：会话恢复（端到端）

**Dependencies**: #4, #5, #6

### #11: 完善文档
**描述**：更新 README 和工具说明文档

**验收标准**：
- [ ] README.md 包含安装步骤
- [ ] README.md 包含使用示例
- [ ] 创建 `docs/tools-specification.md`
- [ ] 更新 ADR 索引

**Dependencies**: #5

---

## P2 Issue 清单（后续版本）

- 性能优化（缓存、批量处理）
- 支持多 LLM（OpenAI/Claude）
- MCP 集成（外部服务）
- 导出功能（PDF/EPUB）

---

## 验证清单

### v0.1.0 发布前必须满足

- [ ] 所有 P0 Issue 完成
- [ ] 所有 P1 Issue 完成
- [ ] 测试覆盖率 >70%
- [ ] CI 全绿
- [ ] 文档完整（README + ADR + 工具说明）

### 实际测试

**测试场景1：创建章节**
```bash
$ novel-agent chat
> 你好
Agent: 您好！我是小说写作助手...

> 帮我创建第1章，主角在2077年的赛博朋克城市中醒来
Agent: 好的，我将为您创建第1章...
[调用 write_chapter(1, content)]
✅ 第1章已创建：chapters/ch001.md
```

**测试场景2：一致性检查**
```bash
> 检查第1章的角色描写是否符合设定
Agent: 我来检查第1章的角色一致性...
[调用 read_file("spec/knowledge/character-profiles.md")]
[调用 read_file("chapters/ch001.md")]
[推理分析...]
✅ 检查完成！
```

---

## 进度追踪

| Issue | 状态 | 负责人 | 预计时间 |
|-------|------|--------|---------|
| #1 项目初始化 | ✅ 完成 | AI | 2025-01-08 |
| #2 Poetry 初始化 | ⏳ 待开始 | - | - |
| #3 实现工具 | ⏳ 待开始 | - | - |
| #4 实现 Agent | ⏳ 待开始 | - | - |
| #5 实现 CLI | ⏳ 待开始 | - | - |
| #6 会话持久化 | ⏳ 待开始 | - | - |
| #7 一致性验证 | ⏳ 待开始 | - | - |
| #8 配置自动化 | ⏳ 待开始 | - | - |
| #9 单元测试 | ⏳ 待开始 | - | - |
| #10 集成测试 | ⏳ 待开始 | - | - |
| #11 完善文档 | ⏳ 待开始 | - | - |

---

## 里程碑说明

由于当前项目没有 GitHub 远程仓库，暂时无法使用 `gh` 命令创建 Milestone 和 Issue。

**两种选择**：

### 选择1：创建 GitHub 仓库（推荐）
```bash
# 创建 GitHub 仓库
gh repo create persomsad/Novel --public --description "小说写作 CLI Agent"

# 推送代码
git remote add origin https://github.com/persomsad/Novel.git
git push -u origin main

# 创建 Milestone
gh api repos/persomsad/Novel/milestones -X POST \
  -f title="v0.1.0" \
  -f description="$(cat docs/v0.1.0-milestone.md)"

# 创建 Issue（示例）
gh issue create \
  --title "使用 Poetry 初始化 Python 项目" \
  --body "..." \
  --milestone "v0.1.0" \
  --label "p0,chore"
```

### 选择2：本地管理（临时）
- 使用本文档追踪进度
- 后续创建 GitHub 仓库后迁移

---

## 下一步行动

1. **立即执行**：决定是否创建 GitHub 仓库
2. **如果创建仓库**：使用 `gh` 命令创建 Milestone 和 Issue
3. **开始开发**：从 #2 开始（Poetry 初始化）
