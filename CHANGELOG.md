# Changelog

本文档记录 Novel Agent 的所有重要变更。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

---

## [0.2.0] - 2025-11-09

### 🎉 主要功能

#### 实时上下文理解 ⭐ 核心突破
- **自动文件监控**: 基于 watchdog 的实时监控，1秒内自动更新索引
- **智能上下文检索**: 图数据库 + grep 混合检索，自动选择相关文档
- **零配置体验**: Agent 自动注入上下文，无需手动指定文件路径
- **像 Claude Code 一样智能**: 学习业界最佳实践，提供顶级开发体验

#### 精准编辑工具
- **行级编辑**: `edit_chapter_lines()` - 精确修改指定行
- **批量替换**: `replace_in_file()` - 查找替换文本
- **原子性多文件编辑**: `multi_edit()` - 批量操作，全部成功或全部失败

#### 智能图查询
- **智能上下文搜索**: `smart_context_search()` - 多跳图遍历 + 置信度评分
- **角色关系网络**: `build_character_network()` - 社区检测 + 关系分析
- **伏笔链条追溯**: `trace_foreshadow()` - 完整伏笔链条可视化

#### 置信度评分机制 ⭐ 新增
- **多维度评估**: 基础分 + 结构化 + 质量 - 扣分项
- **实时显示**: CLI 自动显示评分和图标（🟢80+/🟡60+/🔴59-）
- **质量保障**: 帮助识别低质量回答，提升用户信任度

### 🔧 改进

#### 开发体验
- 多 Agent 系统：支持不同类型的专业 Agent（通用、大纲架构师等）
- 会话持久化：保存创作历史，支持多轮对话续写
- 错误处理优化：更友好的错误提示和日志记录

#### 质量提升
- **测试数量**: 125 → 166 (+41个)
- **测试覆盖率**: 14% → 70% (+56%)
- **类型安全**: 修复所有 mypy 类型错误
- **CI 稳定性**: 保持全绿状态

### 📚 文档

- 完善 README：添加快速开始指南和示例
- 新增 ADR-005：实时上下文理解的技术决策
- 更新工具规范文档

### 🐛 Bug 修复

- 修复测试中的索引文件依赖问题
- 修复 mypy 类型标注错误（21处）
- 优化 CI 配置，避免重复执行

### 🛠️ 技术栈

- LangChain: 0.3.18 → 1.0.4
- LangGraph: 0.2.63
- NervusDB: 本地图数据库
- 新增依赖: watchdog 4.0.0+

---

## [0.1.0] - 2025-11-01

### 🎉 首次发布

- 基础 ReAct Agent 实现
- 5 个核心工具（读取、写入、搜索、验证）
- CLI 界面
- NervusDB 图数据库集成
- Poetry 项目结构
- CI/CD 配置（GitHub Actions）
- Pre-commit hooks（Black, Ruff, mypy, pytest）

---

## [Unreleased]

即将到来的功能：
- VSCode 插件
- Agent 记忆系统增强
- 多模态支持（图片理解）
- 协作功能

---

## 版本说明

- **主版本号（Major）**: 不兼容的 API 变更
- **次版本号（Minor）**: 向下兼容的功能新增
- **修订号（Patch）**: 向下兼容的问题修复

## 链接

- [v0.2.0 对比 v0.1.0](https://github.com/persomsad/Novel/compare/v0.1.0...v0.2.0)
